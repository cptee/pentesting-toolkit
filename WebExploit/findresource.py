import http.client
import argparse
import sys

parser = argparse.ArgumentParser(description='Check for Target Server OPTIONS.')
parser.add_argument('--target', dest='target', help='Target IP', required=True)
parser.add_argument('--port', dest='port', help='Target Port (default=80)', default=80, type=int)
parser.add_argument('--file', dest='file', help='List File', type=argparse.FileType('r'))
parser.add_argument('--list', nargs='+', help='List Pages(e.g. index.html readme.html test.txt)')

args = parser.parse_args()
print('TARGET: ', args.target)
print('PORT  : ', args.port)

if args.file is None and args.list is None:
    sys.exit('Page list or File not specified. -h or --help for more details')

if args.file is not None:
    args.file = args.file.readlines()
else:
    args.file = None
try:
    connection = http.client.HTTPConnection(args.target, args.port)
    for arg in (args.list, args.file):
        if arg is not None:
            for line in arg:
                connection.request('GET', line.replace("\n", ""))
                response = connection.getresponse()
                print('GET', response.status, line.replace("\n", ""))
    connection.close()
except ConnectionRefusedError:
    sys.exit('Connection failed')