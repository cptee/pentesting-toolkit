import http.client
import argparse
import sys

parser = argparse.ArgumentParser(description='Check for Target Server OPTIONS.')
parser.add_argument('--target', dest='target', help='Target IP')
parser.add_argument('--port', dest='port', help='Target Port (default=80)', default=80, type=int)

args = parser.parse_args()

if args.target is None:
    sys.exit('Target not Specified. -h or --help for more details')

try:
    connection = http.client.HTTPConnection(args.target, args.port)
    connection.request('OPTIONS', '/')
    response = connection.getresponse()
    header = response.getheader('allow')
    if header is None:
        print('OPTIONS not enabled')
    else:
        print('Enabled methods are: ', header)
    connection.close()
except ConnectionRefusedError:
    sys.exit('Connection failed')